"use strict";function leftPad(t,e,i="0"){return String(i.repeat(e)+t).slice(-1*e)}class CircularProgress{constructor(t,e){this.circle=t,this.value=e,this.circle.style.display="none"}setTime(t,e,i){this.value.innerHTML=`${leftPad(t,2)}:${leftPad(e,2)}:${leftPad(i,2)}`}setCircle(t,e){if(t>e||t<0)return;let i=(360*t/e).toFixed(1);this.circle.style.background=`conic-gradient(var(--bs-blue) ${i}deg, grey 0deg)`}hide(){this.circle.style.display="none"}show(){this.circle.style.display="block"}}class Control{constructor(t,e,i,s,l){this.container=t,this._start=e,this._pause=i,this._continue=s,this._cancel=l,this._reset(),this._start.style.display="block",this._start.onclick=()=>{var t;null===(t=this.timer)||void 0===t||t.play()},this._pause.onclick=()=>{var t;null===(t=this.timer)||void 0===t||t.pause()},this._cancel.onclick=()=>{var t;null===(t=this.timer)||void 0===t||t.cancel()},this._continue.onclick=()=>{var t;null===(t=this.timer)||void 0===t||t.continue()}}_reset(){this._start.style.display="none",this._pause.style.display="none",this._continue.style.display="none",this._cancel.style.display="none"}start(){this._reset(),this._start.style.display="block"}pause(){this._reset(),this._continue.style.display="block",this._cancel.style.display="block"}play(){this._reset(),this._pause.style.display="block",this._cancel.style.display="block"}continue(){this._reset(),this._pause.style.display="block",this._cancel.style.display="block"}cancel(){this._reset(),this._start.style.display="block"}setTimer(t){this.timer=t}}class Picker{constructor(t,e,i,s){this.container=t,this._hours=e,this._minutes=i,this._seconds=s}hide(){this.container.style.display="none"}show(){this.container.style.display="block"}get time(){let t=""==this._hours.value?0:parseInt(this._hours.value),e=""==this._minutes.value?0:parseInt(this._minutes.value),i=""==this._seconds.value?0:parseInt(this._seconds.value);return t*HOURS+e*MINUTES+i*SECONDS}}const SECONDS=1e3,MINUTES=60*SECONDS,HOURS=60*MINUTES;window.addEventListener("load",()=>{let t=new Control(document.getElementById("buttons"),document.getElementById("btn-start"),document.getElementById("btn-pause"),document.getElementById("btn-continue"),document.getElementById("btn-cancel")),e=new Picker(document.getElementById("picker-container"),document.getElementById("picker-hours"),document.getElementById("picker-minutes"),document.getElementById("picker-seconds")),i=new CircularProgress(document.getElementById("circle"),document.getElementById("circle-value")),s=new Sound(document.getElementById("wecker")),l=new Timer(t,i,e,s);t.setTimer(l)});class Sound{constructor(t){this._wecker=t}play(){this._wecker.currentTime=0,this._wecker.play(),this._wecker.loop=!0}stop(){this._wecker.pause()}}const DELAY=50;class Timer{constructor(t,e,i,s){this.interval_id=NaN,this.timeLeft=0,this.beforeTime=0,this._control=t,this.display=e,this.picker=i,this.sound=s}get control(){return this._control}clock(){let t=Date.now(),e=t-this.beforeTime;if(this.timeLeft-e<0){clearInterval(this.interval_id),this.interval_id=NaN,this.timeLeft=0,this.picker.show(),this.control.start(),this.display.hide(),this.sound.play(),this.timeOut();return}this.timeLeft-=e,this.beforeTime=t,this.setTime()}play(){0!=this.picker.time&&(this.timeLeft=this.picker.time,isNaN(this.interval_id)&&(this.picker.hide(),this.setTime(),this.display.show(),this.beforeTime=Date.now(),this.control.play(),this.interval_id=setInterval(()=>{this.clock()},50)))}pause(){isNaN(this.interval_id)||(clearInterval(this.interval_id),this.interval_id=NaN,this.control.pause())}continue(){this.control.continue(),this.beforeTime=Date.now(),this.interval_id=setInterval(()=>{this.clock()},50)}cancel(){clearInterval(this.interval_id),this.interval_id=NaN,this.timeLeft=0,this.setTime(),this.picker.show(),this.display.hide(),this.control.cancel()}setTime(){let t=Math.floor(this.timeLeft/HOURS),e=Math.floor(this.timeLeft%HOURS/MINUTES),i=Math.floor(this.timeLeft%MINUTES/SECONDS);this.display.setTime(t,e,i),this.display.setCircle(this.timeLeft,this.picker.time)}timeOut(){var t;let e=new bootstrap.Modal("#modal");null===(t=document.getElementById("modal"))||void 0===t||t.addEventListener("hidden.bs.modal",()=>{this.sound.stop()}),e.show()}}